
<main>
  
  <div class="diapo">
      <div class="elements">
        {% assign premier = true %}
        {%for block in section.blocks %}
        		{% if premier == true%}
                  <div class="element active">

                          <img class="imageHomePage" srcset ="{{block.settings.image | img_url:'master'}}"/>

                      <div class="caption">
                        
 
                      </div>
                    </div>
            		{% assign premier = false %}
            	{% elsif premier == false%}
                    <div class="element">

                            <img class="imageHomePage" srcset ="{{block.settings.image | img_url:'master'}}"/>

                        <div class="caption">
                          

                        </div>
                      </div>
            	{% endif %}
          
        {%endfor%}
       </div>
    {% if section.settings.fleche %}
    <div id="nav-gauche" class="las la-chevron-left"><img id="image-gauche" src="{{section.settings.fleche | img_url:'50px'}}"></div>	
    <div id="nav-droite" class="las la-chevron-right"><img src="{{section.settings.fleche | img_url:'50px'}}"></div>
    {% else %}
    <div id="nav-gauche" class="las la-chevron-left">←</div>	
    <div id="nav-droite" class="las la-chevron-right">→</div>
    {% endif %} 
    <div class="informationBox">
      <h2 class="titre">{{section.settings.heading}}</h2>
      <h3 class="sousText">{{section.settings.sousText}}</h3>

      <a class="lienHomePage" href="{{section.settings.buttonLien}}">
        <div class="bouton"><p class="textBouton">{{section.settings.buttonText}}</p></div>
      </a>
      <div id="petitPoint">
      </div> 
    </div>
    
    <div id="data">
      <div id="time">
        {{section.settings.transitionTime}}
      </div>
      <div id ="color1">
        {{section.settings.points}}
      </div>
      <div id ="color2">
        {{section.settings.lePoint}} 
      </div>
    </div>
    
  </div>
</main>
{% schema %} 
  {
    "name": "Diaporama",
    "settings": [
					{
						"type":"text",
						"label":"titre",
						"id":"heading"
					},
  					{
						"type":"text",
						"label":"sous-text",
						"id":"sousText"
					},
  					{
						"type":"text",
						"label":"text-bouton",
						"id":"buttonText"
					},
  					{
						"type":"text",
						"label":"lien-bouton",
						"id":"buttonLien"
					},
  					{
						"type":"text",
						"label":"temp entre les transition (en ms)",
						"id":"transitionTime"
					},
					{
						"type":"image_picker",
						"label":"Les flêches",
						"id" : "fleche"
					},
					{
						"type":"color",
						"label":"les points", 
						"id" : "points" 
					},
					{
						"type":"color",
						"label":"le Point",
						"id" : "lePoint"
					}

				],
	"blocks" : [
				{
					"type":"image",
					"name":"image block",
					"settings":[
								{
									"type":"image_picker",
									"label":"Les images",
									"id" : "image"
								}
								]
				}
	],
    "presets": [
                    {
                      "name": "Diaporama",
                      "category": "banner"
                    }
	
    ]
  }
{% endschema %}

{% stylesheet %}



body{
	margin:0;
}

main{
	width:100%;
	margin:auto;
}

.diapo{
	position: relative;
	overflow: hidden;

}

#nav-droite,#nav-gauche{
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	color: white;
	font-size: 3em;
	
	width:100px;
	height:50px; 
}

#nav-droite{
	right: 20px;
}

#nav-gauche{
	left: 20px;
}

#image-gauche{
	transform: rotate(0.5turn);  
}

.titre{
	 
	color:white;
	font-size: 30px;
}

.sousText{
	
	color:white;
	font-size: 25px;
}

.lienHomePage{ 
	
}
.bouton{ 
	width: 200px; 
	height:50px;
	background-color:white;
	border-radius:5px;

	display:flex;
	justify-content:center;
	align-items:center; 
}
.textBouton{ 
	color:blue;
	font-size: 18px
}
.informationBox{
	display:flex;
	justify-content:center;
	align-items:center; 
	flex-direction: column;

	z-index:2; 
	
	position: absolute;
	top:20%;
	left:30%; 
	
}

@media screen and (max-width: 1024px)
{
	.titre{
		font-size: 25px;
	} 
    .sousText{
		font-size: 20px;
	}
	.textBouton{
		font-size: 12px
	}
	.informationBox{
	
      top:10%;
      left:15%;  
	
	}
	#nav-droite,#nav-gauche{
		top:60%; 
	}
}


.elements{
	display: flex;
	transition: 1s linear;
}

.element{
	flex:1 0 100%;
	position: relative;
}

.element > img{
	width: 100%
}

.imageHomePage{
	
	
	width:100%;
	 
}

.caption{
	/*position: absolute;
	top: 30%;
	left:60%;
	transform: translate(-50%, -50%);
	text-align:center;
	background-color: rgba(255,255,255,0.4);
	padding: 30px;*/
} 


#petitPoint{
	display:flex;  
}

.point{
	font-size:30px; 
}

.data{
	position: absolute;
	top:20%;
	left:3000px;  
}
 
{% endstylesheet %}

{% javascript %}
	
	
	//variables
	let compteur = 0
	let timer, elements, slides, slideWidth   
	const boitePoint = document.getElementById("petitPoint")  

	var time = document.getElementById("time").innerText; 
	var color1 = document.getElementById("color1").innerText;
	var color2 = document.getElementById("color2").innerText;

	window.onload = () => {
	
	const diapo = document.querySelector(".diapo")
	elements = document.querySelector(".elements")
	slides = document.getElementsByClassName("element")
	
	//largeur du diapo
	slideWidth = diapo.getBoundingClientRect().width
	
	let next = document.querySelector("#nav-droite")
	let prev = document.querySelector("#nav-gauche")

	nImage = slides.length;
	

	
	for(i=0;i<nImage;i++){ 
        point = document.createElement("div")  
    	boitePoint.appendChild(point)  
  		
        point.classList.add("point")
        point.innerHTML = "•"    
    }
    pointColor() 

	next.addEventListener("click",slideNext)
	prev.addEventListener("click",slidePrev) 

	// diapo automatisé

	timer = setInterval(slideNext, time)
    
    next.addEventListener("mouseover",stopTimer)
	next.addEventListener("mouseout",startTimer)

	prev.addEventListener("mouseover",stopTimer)
	prev.addEventListener("mouseout",startTimer)

	//responsive disigne

	window.addEventListener("resize",function(){
	 slideWidth = diapo.getBoundingClientRect().width
	 slideNext() 
	});

	}

	
  function slideNext(){  
	  console.log("test")
      compteur++
      compteur %= nImage 
      let decal = -slideWidth * compteur
	  elements.style.transform = `translateX(${decal}px)`
                           
      pointColor()
  }

  function slidePrev(){  
	  console.log("test") 
      compteur--
	  if(compteur == -1){
		compteur = nImage -1 
		}
      let decal = -slideWidth * compteur
	  elements.style.transform = `translateX(${decal}px)`

	  pointColor() 
      for(i=0;i<1;i++){} 
  }

	
  function stopTimer(){
		clearInterval(timer)
  }
 
  function startTimer(){
		timer = setInterval(slideNext, time)     
  }

  function pointColor(){
	var lesPoints = document.getElementsByClassName("point")
      for(i=0;i<nImage;i++){
		if(i==compteur){
			lesPoints[i].style.color = color2;    
		}else{
			lesPoints[i].style.color = color1;  
		}
	  }
  
  }

 
{% endjavascript %}
