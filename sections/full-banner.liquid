
<main>
  <h1>{{section.settings.heading}}</h1>
  <div class="diapo">
      <div class="elements">
        {% assign premier = true %}
        {%for block in section.blocks %}
        		{% if premier == true%}
                  <div class="element active">

                          <img class="imageHomePage" srcset ="{{block.settings.image | img_url:'master'}}"/>

                      <div class="caption">
                        <h2>Image</h2>

                      </div>
                    </div>
            		{% assign premier = false %}
            	{% elsif premier == false%}
                    <div class="element">

                            <img class="imageHomePage" srcset ="{{block.settings.image | img_url:'master'}}"/>

                        <div class="caption">
                          <h2>Image</h2>

                        </div>
                      </div>
            	{% endif %}
          
        {%endfor%}
       </div>
    <i id="nav-gauche" class="las la-chevron-left">←</i>	
    <i id="nav-droite" class="las la-chevron-right">→</i>
  </div>
</main>
{% schema %}
  {
    "name": "Diaporama",
    "settings": [
					{
						"type":"text",
						"label":"titre",
						"id":"heading"
					}

				],
	"blocks" : [
				{
					"type":"image",
					"name":"image block",
					"settings":[
								{
									"type":"image_picker",
									"label":"Les images",
									"id" : "image"
								}
								]
				}
	],
    "presets": [
                    {
                      "name": "Diaporama",
                      "category": "banner"
                    }
	
    ]
  }
{% endschema %}

{% stylesheet %}



body{
	margin:0;
}

main{
	width:100%;
	margin:auto;
}

.diapo{
	position: relative;
	overflow: hidden;
}

#nav-droite,#nav-gauche{
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	color: white;
	font-size: 3em;
}

#nav-droite{
	right: 20px;
}

#nav-gauche{
	left: 20px;
}


.elements{
	display: flex;
	transition: 1s linear;
}

.element{
	flex:1 0 100%;
	position: relative;
}

.element > img{
	width: 100%
}

.imageHomePage{
	
	
	width:100%;
	min-width:800px;
}

.caption{
	position: absolute;
	top: 50%;
	left:50%;
	transform: translate(-50%, -50%);
	text-align:center;
	background-color: rgba(255,255,255,0.4);
	padding: 30px;
}

{% endstylesheet %}

{% javascript %}

	//variables
	let compteur = 0
	let timer, elements, slides, slideWidth

	window.onload = () => {
	
	const diapo = document.querySelector(".diapo")
	elements = document.querySelector(".elements")
	slides = document.getElementsByClassName("element")
	
	//largeur du diapo
	slideWidth = diapo.getBoundingClientRect().width
	
	let next = document.querySelector("#nav-droite")
	let prev = document.querySelector("#nav-gauche")

	nImage = slides.length;

	next.addEventListener("click",slideNext)
	prev.addEventListener("click",slidePrev) 

	// diapo automatisé

	timer = setInterval(slideNext, 6000)
    
    next.addEventListener("mouseover",stopTimer)
	next.addEventListener("mouseout",startTimer)

	prev.addEventListener("mouseover",stopTimer)
	prev.addEventListener("mouseout",startTimer)
	}

	
  function slideNext(){  
	  console.log("test")
      compteur++
      compteur %= nImage 
      let decal = -slideWidth * compteur
	  elements.style.transform = `translateX(${decal}px)`
  }

  function slidePrev(){  
	  console.log("test") 
      compteur--
	  if(compteur == -1){
		compteur = nImage -1 
		}
      let decal = -slideWidth * compteur
	  elements.style.transform = `translateX(${decal}px)`
  }

	
  function stopTimer(){
		clearInterval(timer)
  }
 
  function startTimer(){
		timer = setInterval(slideNext, 6000)
  }

 
{% endjavascript %}
